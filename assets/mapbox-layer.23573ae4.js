import{e as A,b as I,u as j,O as C,f as B,P as Q,Q as $,R as W,K as h}from"./index.7a4453cf.js";import{D as z,e as G,W as K,f as U,_ as f}from"./layer.6384b77b.js";var D;const b=typeof window<"u",q=e=>typeof e<"u",O=e=>typeof e=="function",J=e=>typeof e=="string";b&&((D=window?.navigator)==null?void 0:D.userAgent)&&/iP(ad|hone|od)/.test(window.navigator.userAgent);function Z(e){return typeof e=="function"?e():j(e)}function H(e){return e}function Y(e){return $()?(W(e),!0):!1}function X(e){return typeof e=="function"?A(e):I(e)}function k(e,t=!0){C()?B(e):t?e():Q(e)}function ee(e){var t;const n=Z(e);return(t=n?.$el)!=null?t:n}const te=b?window:void 0,ne=b?window.document:void 0;b&&window.navigator;b&&window.location;function re(e,t=!1){const n=I(),r=()=>n.value=Boolean(e());return r(),k(r,t),n}function ie(e){return JSON.parse(JSON.stringify(e))}const _=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},x="__vueuse_ssr_handlers__";_[x]=_[x]||{};_[x];var R=Object.getOwnPropertySymbols,ae=Object.prototype.hasOwnProperty,oe=Object.prototype.propertyIsEnumerable,se=(e,t)=>{var n={};for(var r in e)ae.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&R)for(var r of R(e))t.indexOf(r)<0&&oe.call(e,r)&&(n[r]=e[r]);return n};function le(e,t,n={}){const r=n,{window:i=te}=r,a=se(r,["window"]);let u;const o=re(()=>i&&"MutationObserver"in i),s=()=>{u&&(u.disconnect(),u=void 0)},d=h(()=>ee(e),m=>{s(),o.value&&i&&m&&(u=new MutationObserver(t),u.observe(m,a))},{immediate:!0}),l=()=>{s(),d()};return Y(l),{isSupported:o,stop:l}}var V;(function(e){e.UP="UP",e.RIGHT="RIGHT",e.DOWN="DOWN",e.LEFT="LEFT",e.NONE="NONE"})(V||(V={}));function Pe(e=null,t={}){var n,r;const{document:i=ne}=t,a=X((n=e??i?.title)!=null?n:null),u=e&&O(e);function o(s){if(!("titleTemplate"in t))return s;const d=t.titleTemplate||"%s";return O(d)?d(s):j(d).replace(/%s/g,s)}return h(a,(s,d)=>{s!==d&&i&&(i.title=o(J(s)?s:""))},{immediate:!0}),t.observe&&!t.titleTemplate&&i&&!u&&le((r=i.head)==null?void 0:r.querySelector("title"),()=>{i&&i.title!==a.value&&(a.value=o(i.title))},{childList:!0}),a}var ue=Object.defineProperty,N=Object.getOwnPropertySymbols,de=Object.prototype.hasOwnProperty,ce=Object.prototype.propertyIsEnumerable,T=(e,t,n)=>t in e?ue(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,pe=(e,t)=>{for(var n in t||(t={}))de.call(t,n)&&T(e,n,t[n]);if(N)for(var n of N(t))ce.call(t,n)&&T(e,n,t[n]);return e};const fe={easeInSine:[.12,0,.39,0],easeOutSine:[.61,1,.88,1],easeInOutSine:[.37,0,.63,1],easeInQuad:[.11,0,.5,0],easeOutQuad:[.5,1,.89,1],easeInOutQuad:[.45,0,.55,1],easeInCubic:[.32,0,.67,0],easeOutCubic:[.33,1,.68,1],easeInOutCubic:[.65,0,.35,1],easeInQuart:[.5,0,.75,0],easeOutQuart:[.25,1,.5,1],easeInOutQuart:[.76,0,.24,1],easeInQuint:[.64,0,.78,0],easeOutQuint:[.22,1,.36,1],easeInOutQuint:[.83,0,.17,1],easeInExpo:[.7,0,.84,0],easeOutExpo:[.16,1,.3,1],easeInOutExpo:[.87,0,.13,1],easeInCirc:[.55,0,1,.45],easeOutCirc:[0,.55,.45,1],easeInOutCirc:[.85,0,.15,1],easeInBack:[.36,0,.66,-.56],easeOutBack:[.34,1.56,.64,1],easeInOutBack:[.68,-.6,.32,1.6]};pe({linear:H},fe);function Le(e,t,n,r={}){var i,a,u;const{clone:o=!1,passive:s=!1,eventName:d,deep:l=!1,defaultValue:m}=r,c=C(),S=n||c?.emit||((i=c?.$emit)==null?void 0:i.bind(c))||((u=(a=c?.proxy)==null?void 0:a.$emit)==null?void 0:u.bind(c?.proxy));let y=d;t||(t="modelValue"),y=d||y||`update:${t.toString()}`;const E=p=>o?O(o)?o(p):ie(p):p,M=()=>q(e[t])?E(e[t]):m;if(s){const p=M(),w=I(p);return h(()=>e[t],g=>w.value=E(g)),h(w,g=>{(g!==e[t]||l)&&S(y,g)},{deep:l}),w}else return A({get(){return M()},set(p){S(y,p)}})}const v="https://basemaps.cartocdn.com/gl/{basemap}-gl-style/style.json",Se={VOYAGER:v.replace("{basemap}","voyager"),POSITRON:v.replace("{basemap}","positron"),DARK_MATTER:v.replace("{basemap}","dark-matter"),VOYAGER_NOLABELS:v.replace("{basemap}","voyager-nolabels"),POSITRON_NOLABELS:v.replace("{basemap}","positron-nolabels"),DARK_MATTER_NOLABELS:v.replace("{basemap}","dark-matter-nolabels")};function ve({map:e,gl:t,deck:n}){if(e.__deck)return e.__deck;const r=n?.props._customRender,i=be({...n?.props,_customRender:()=>{e.triggerRepaint(),r?.("")}});let a;return(!n||n.props.gl===t)&&(Object.assign(i,{gl:t,width:null,height:null,touchAction:"unset",viewState:P(e)}),e.on("move",()=>_e(a,e))),n?(a=n,n.setProps(i),n.userData.isExternal=!0):(a=new z(i),e.on("remove",()=>{a.finalize(),e.__deck=null})),a.userData.mapboxLayers=new Set,a.userData.mapboxVersion=we(e),e.__deck=a,e.on("render",()=>{a.isInitialized&&Oe(a,e)}),a}function be(e){const t="useDevicePixels"in e?e.useDevicePixels:!0;return{...e,useDevicePixels:t,parameters:{depthMask:!0,depthTest:!0,blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthFunc:515,blendEquation:32774,...e.parameters},views:e.views||[new G({id:"mapbox"})]}}function me(e,t){e.userData.mapboxLayers.add(t),L(e)}function ye(e,t){e.userData.mapboxLayers.delete(t),L(e)}function ge(e,t){L(e)}function he(e,t,n){let{currentViewport:r}=e.userData,i=!1;r||(r=F(e,t,!0),e.userData.currentViewport=r,i=!0),e.isInitialized&&e._drawLayers("mapbox-repaint",{viewports:[r],layerFilter:({layer:a})=>n.id===a.id,clearStack:i,clearCanvas:!1})}function P(e){const{lng:t,lat:n}=e.getCenter();return{longitude:(t+540)%360-180,latitude:n,zoom:e.getZoom(),bearing:e.getBearing(),pitch:e.getPitch(),padding:e.getPadding(),repeat:e.getRenderWorldCopies()}}function we(e){let t=0,n=0;const r=e.version;return r&&([t,n]=r.split(".").slice(0,2).map(Number)),{major:t,minor:n}}function F(e,t,n=!0){const{mapboxVersion:r}=e.userData;return new K(Object.assign({id:"mapbox",x:0,y:0,width:e.width,height:e.height},P(t),n?{nearZMultiplier:r.major===1&&r.minor>=3||r.major>=2?.02:1/(e.height||1)}:{nearZMultiplier:.1}))}function Oe(e,t){const{mapboxLayers:n,isExternal:r}=e.userData;if(r){const i=Array.from(n,l=>l.id),u=U(e.props.layers,Boolean).some(l=>l&&!i.includes(l.id));let o=e.getViewports();const s=o.findIndex(l=>l.id==="mapbox"),d=o.length>1||s<0;(u||d)&&(s>=0&&(o=o.slice(),o[s]=F(e,t,!1)),e._drawLayers("mapbox-repaint",{viewports:o,layerFilter:l=>(!e.props.layerFilter||e.props.layerFilter(l))&&(l.viewport.id!=="mapbox"||!i.includes(l.layer.id)),clearCanvas:!1}))}e.userData.currentViewport=null}function _e(e,t){e.setProps({viewState:P(t)}),e.needsRedraw({clearRedrawFlags:!0})}function L(e){if(e.userData.isExternal)return;const t=[];e.userData.mapboxLayers.forEach(n=>{const r=n.props.type,i=new r(n.props);t.push(i)}),e.setProps({layers:t})}class Ee{constructor(t){if(f(this,"id",void 0),f(this,"type",void 0),f(this,"renderingMode",void 0),f(this,"map",void 0),f(this,"deck",void 0),f(this,"props",void 0),!t.id)throw new Error("Layer must have an unique id");this.id=t.id,this.type="custom",this.renderingMode=t.renderingMode||"3d",this.map=null,this.deck=null,this.props=t}onAdd(t,n){this.map=t,this.deck=ve({map:t,gl:n,deck:this.props.deck}),me(this.deck,this)}onRemove(){this.deck&&ye(this.deck,this)}setProps(t){Object.assign(this.props,t,{id:this.id}),this.deck&&ge(this.deck)}render(){he(this.deck,this.map,this)}}export{Se as B,Ee as M,Pe as a,be as b,ve as c,P as g,Le as u};
